"use strict";(self["webpackChunkdatabasir"]=self["webpackChunkdatabasir"]||[]).push([[770],{38787:function(n,t,e){e.d(t,{aF:function(){return u},nK:function(){return a},Hj:function(){return i},Jp:function(){return c},FO:function(){return l},ri:function(){return f},KT:function(){return s},ec:function(){return d}});var r=e(63872),o="/oauth2",u=function(){return r.Z.get(o+"/apps")},a=function(n,t){return r.Z.get(o+"/authorization/"+n,{params:t})},p="/api/v1.0/oauth2_apps",i=function(n){return r.Z.get(p,{params:n})},c=function(n){return r.Z["delete"](p+"/"+n)},l=function(n){return r.Z.get(p+"/"+n)},f=function(n){return r.Z.post(p,n)},s=function(n){return r.Z.patch(p,n)},d=function(){return r.Z.get(p+"/platforms")}},63766:function(n,t,e){e.d(t,{Z:function(){return s}});var r=e(66252),o=e(3577),u=["src"],a=["src"],p=["src"];function i(n,t,i,c,l,f){var s=(0,r.up)("el-tooltip");return"github"==i.appType.toLowerCase()?((0,r.wg)(),(0,r.j4)(s,{key:0,content:i.appName,effect:"light"},{default:(0,r.w5)((function(){return[(0,r._)("img",{src:i.appIcon?i.appIcon:e(39710),style:{"max-width":"20px","max-height":"20px"}},null,8,u)]})),_:1},8,["content"])):"gitlab"==i.appType.toLowerCase()?((0,r.wg)(),(0,r.j4)(s,{key:1,content:i.appName,effect:"light"},{default:(0,r.w5)((function(){return[(0,r._)("img",{src:i.appIcon?i.appIcon:e(84386),style:{"max-width":"20px","max-height":"20px"}},null,8,a)]})),_:1},8,["content"])):"we_work"==i.appType.toLowerCase()?((0,r.wg)(),(0,r.j4)(s,{key:2,content:i.appName,effect:"light"},{default:(0,r.w5)((function(){return[(0,r._)("img",{src:i.appIcon?i.appIcon:e(51457),style:{"max-width":"20px","max-height":"20px"}},null,8,p)]})),_:1},8,["content"])):((0,r.wg)(),(0,r.iD)(r.HY,{key:3},[(0,r.Uk)((0,o.zw)(i.appType),1)],64))}var c={props:{appType:String,appIcon:String,appName:String}},l=e(83744);const f=(0,l.Z)(c,[["render",i]]);var s=f},57770:function(n,t,e){e.r(t),e.d(t,{default:function(){return y}});var r=e(66252),o=e(49963),u={class:"login-card"},a=(0,r._)("h1",null,"Databasir",-1),p=(0,r.Uk)(" 登录 "),i=(0,r.Uk)(" 忘记密码？ "),c=(0,r.Uk)(" 第三方登录 ");function l(n,t,e,l,f,s){var d=(0,r.up)("el-header"),m=(0,r.up)("el-link"),g=(0,r.up)("el-form-item"),h=(0,r.up)("el-button"),w=(0,r.up)("el-tooltip"),y=(0,r.up)("el-space"),_=(0,r.up)("oauth2-app-type"),k=(0,r.up)("el-divider"),v=(0,r.up)("el-form"),b=(0,r.up)("el-main"),x=(0,r.up)("el-container");return(0,r.wg)(),(0,r.j4)(x,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(d),(0,r.Wm)(b,{class:"login-main"},{default:(0,r.w5)((function(){return[(0,r._)("div",u,[(0,r.Wm)(v,{ref:"formRef",rules:f.formRule,model:f.form,style:{border:"none"}},{default:(0,r.w5)((function(){return[(0,r.Wm)(g,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(m,{href:"https://github.com/vran-dev/databasir",target:"_blank",underline:!1,type:"info"},{default:(0,r.w5)((function(){return[a]})),_:1})]})),_:1}),(0,r.Wm)(g,{prop:"username"},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r._)("input",{type:"text",class:"login-input",placeholder:"用户名或邮箱","onUpdate:modelValue":t[0]||(t[0]=function(n){return f.form.username=n}),onKeyup:t[1]||(t[1]=(0,o.D2)((function(n){return s.onLogin("formRef")}),["enter"]))},null,544),[[o.nr,f.form.username]])]})),_:1}),(0,r.Wm)(g,{prop:"password"},{default:(0,r.w5)((function(){return[(0,r.wy)((0,r._)("input",{type:"password",class:"login-input",placeholder:"密码","onUpdate:modelValue":t[2]||(t[2]=function(n){return f.form.password=n}),onKeyup:t[3]||(t[3]=(0,o.D2)((function(n){return s.onLogin("formRef")}),["enter"]))},null,544),[[o.nr,f.form.password]])]})),_:1}),(0,r.Wm)(g,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{size:32},{default:(0,r.w5)((function(){return[(0,r.Wm)(h,{style:{width:"120px","margin-top":"10px","border-color":"#EEE"},color:"#000",onClick:t[4]||(t[4]=function(n){return s.onLogin("formRef")}),plain:"",round:""},{default:(0,r.w5)((function(){return[p]})),_:1}),(0,r.Wm)(w,{content:"请联系管理员为您重置密码"},{default:(0,r.w5)((function(){return[(0,r.Wm)(m,{target:"_blank",underline:!1,type:"info"},{default:(0,r.w5)((function(){return[i]})),_:1})]})),_:1})]})),_:1})]})),_:1}),(0,r.Wm)(g,null,{default:(0,r.w5)((function(){return[f.oauthApps.length>0?((0,r.wg)(),(0,r.j4)(k,{key:0,"content-position":"right"},{default:(0,r.w5)((function(){return[(0,r.Wm)(y,{size:26},{default:(0,r.w5)((function(){return[c,((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(f.oauthApps,(function(n,t){return(0,r.wg)(),(0,r.j4)(m,{key:t,underline:!1,onClick:function(t){return s.onAuthLogin(n.registrationId)}},{default:(0,r.w5)((function(){return[(0,r.Wm)(_,{"app-type":n.appType,"app-icon":n.appIcon,"app-name":n.appName},null,8,["app-type","app-icon","app-name"])]})),_:2},1032,["onClick"])})),128))]})),_:1})]})),_:1})):(0,r.kq)("",!0)]})),_:1})]})),_:1},8,["rules","model"])])]})),_:1})]})),_:1})}var f=e(40152),s=e(51836),d=e(38787),m=e(63766),g={components:{Oauth2AppType:m.Z},data:function(){return{form:{username:null,password:null},formRule:{username:[{required:!0,message:"请输入用户名或邮箱",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},oauthApps:[]}},created:function(){this.fetchAllOAuthApps()},methods:{resolveAppIcon:function(n){return n.appIcon&&""!=n.appIcon?n.appIcon:"github"==n.appType?e(39710):"gitlab"==n.appType?e(84386):""},fetchAllOAuthApps:function(){var n=this;(0,d.aF)().then((function(t){t.errCode||(n.oauthApps=t.data)}))},toIndexPage:function(){this.$router.push({path:"/groups"})},onAuthLogin:function(n){var t=window.location.protocol,e=t+"//"+window.location.host+"/login/oauth2/"+n,r={redirect_uri:e};(0,d.nK)(n,r).then((function(n){n.errCode||(window.location.href=n.data)}))},onLogin:function(){var n=this;this.$refs.formRef.validate((function(t){t&&(0,f.x4)(n.form).then((function(t){t.errCode||(s.E.saveUserLoginData(t.data),n.$store.commit("userUpdate",{nickname:t.data.nickname,username:t.data.username,email:t.data.email}),n.toIndexPage())}))}))}}},h=e(83744);const w=(0,h.Z)(g,[["render",l]]);var y=w},39710:function(n,t,e){n.exports=e.p+"img/github.e45f4724.svg"},84386:function(n,t,e){n.exports=e.p+"img/gitlab.6b1155ee.svg"},51457:function(n,t,e){n.exports=e.p+"img/wework.aaf3f725.svg"}}]);
//# sourceMappingURL=770-legacy.9cb39330.js.map