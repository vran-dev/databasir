{"version":3,"sources":["webpack:///./src/views/UserProfile.vue","webpack:///./src/views/UserProfile.vue?9b7f","webpack:///./src/api/User.js","webpack:///./src/assets/logo.png"],"names":["shadow","style","src","label-position","label-width","model","userFormData","label","span","nickname","maxlength","isNickNameChanged","offset","plain","icon","circle","size","onUpdateNickname","username","disabled","email","type","password","onShowUpdatePasswordDialog","isShowUpdatePasswordDialog","title","width","before-close","onUpdatePasswordDialogClose","userPasswordUpdateForm","rules","userPasswordUpdateFormRule","ref","prop","originPassword","placeholder","newPassword","show-word-limit","show-password","confirmNewPassword","onUpdatePassword","data","validatePasswordIsEq","rule","value","callback","Error","required","message","trigger","min","max","validator","userId","watch","newVal","this","$store","state","user","mounted","loadUserLoginData","id","methods","$refs","userPasswordUpdateFormRef","validate","valid","then","resp","errCode","$message","success","removeUserLoginData","$router","push","path","error","commit","warning","__exports__","render","base","listUsers","pageQuery","axios","get","params","enableUser","post","disableUser","getByUserId","createUser","request","renewPassword","addSysOwnerTo","removeSysOwnerFrom","delete","updatePassword","body","updateNickname","module","exports"],"mappings":"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","file":"js/chunk-fffb1b64.1ffb9f27.js","sourcesContent":["<template>\r\n    <el-container>\r\n        <el-header>\r\n        </el-header>\r\n        <el-main>\r\n            <el-card shadow=\"hover\" style=\"max-width: 600px\">\r\n                <img :src=\"require('@/assets/logo.png')\" style=\"max-width: 330px; max-height: 330px;\"/>\r\n\r\n                <el-form\r\n                    label-position=\"top\"\r\n                    label-width=\"100px\"\r\n                    :model=\"userFormData\"\r\n                    style=\"max-width: 460px\"\r\n                >\r\n                    <el-form-item label=\"昵称\">\r\n                        <el-col :span=\"20\"> \r\n                            <el-input v-model=\"userFormData.nickname\" maxlength=\"32\"></el-input>\r\n                        </el-col>\r\n                        <el-col :span=\"2\" :offset=\"1\" v-if=\"isNickNameChanged\">\r\n                            <el-button plain icon=\"Check\" circle size=\"small\" @click=\"onUpdateNickname\" ></el-button>\r\n                        </el-col>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"用户名\">\r\n                        <el-col :span=\"20\">\r\n                            <el-input v-model=\"userFormData.username\" disabled></el-input>\r\n                        </el-col>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"邮箱\">\r\n                        <el-col :span=\"20\">\r\n                            <el-input v-model=\"userFormData.email\" disabled></el-input>\r\n                        </el-col>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"密码\">\r\n                        <el-col :span=\"12\">\r\n                            <el-input disabled type=\"password\"  v-model=\"userFormData.password\"></el-input>\r\n                        </el-col>\r\n                        <el-col :span=\"11\" :offset=\"1\">\r\n                            <el-button type=\"danger\" plain @click=\"onShowUpdatePasswordDialog\" icon=\"edit\" >修改密码</el-button>\r\n                        </el-col>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-card>\r\n\r\n            <el-dialog\r\n                v-model=\"isShowUpdatePasswordDialog\"\r\n                title=\"修改密码\"\r\n                width=\"33%\"\r\n                :before-close=\"onUpdatePasswordDialogClose\"\r\n            >\r\n                <el-form\r\n                    label-position=\"top\"\r\n                    label-width=\"100px\"\r\n                    :model=\"userPasswordUpdateForm\"\r\n                    :rules=\"userPasswordUpdateFormRule\"\r\n                    ref=\"userPasswordUpdateFormRef\"\r\n                >\r\n                    <el-form-item label=\"原密码\" prop=\"originPassword\">\r\n                        <el-input v-model=\"userPasswordUpdateForm.originPassword\" placeholder=\"请输入原登录密码\"  type=\"password\"></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n                        <el-input v-model=\"userPasswordUpdateForm.newPassword\" placeholder=\"输入新密码\"  type=\"password\" maxlength=\"32\" show-word-limit show-password></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item label=\"再次输入新密码\" prop=\"confirmNewPassword\">\r\n                        <el-input v-model=\"userPasswordUpdateForm.confirmNewPassword\"  type=\"password\" placeholder=\"再次输入新密码\" maxlength=\"32\" show-word-limit show-password></el-input>\r\n                    </el-form-item>\r\n                    <el-form-item>\r\n                        <el-button @click=\"onUpdatePassword('userPasswordUpdateFormRef')\" type=\"primary\">确认</el-button>\r\n                        <el-button @click=\"isShowUpdatePasswordDialog = false\">取消</el-button>\r\n                    </el-form-item>\r\n                </el-form>\r\n            </el-dialog>\r\n        </el-main>\r\n    </el-container>\r\n</template>\r\n\r\n<script>\r\nimport { updatePassword, updateNickname } from \"../api/User\";\r\nimport { user } from \"../utils/auth\";\r\nexport default {\r\n    data() {\r\n        const validatePasswordIsEq = (rule, value, callback) => {\r\n            if (value  == this.userPasswordUpdateForm.newPassword && !this.userPasswordUpdateForm.confirmNewPassword) {\r\n                callback();\r\n                return;\r\n            }\r\n\r\n            if(value  == this.userPasswordUpdateForm.newPassword && value != this.userPasswordUpdateForm.confirmNewPassword) {\r\n                callback(new Error('两次输入密码不一致!'));\r\n                return;\r\n            }\r\n\r\n            if (value == this.userPasswordUpdateForm.confirmNewPassword && value != this.userPasswordUpdateForm.newPassword) {\r\n                callback(new Error('两次输入密码不一致!'));\r\n                return;\r\n            }\r\n\r\n            callback();\r\n        };\r\n        return {\r\n            userFormData: {\r\n                password: '..........',\r\n                nickname: null,\r\n                username: null,\r\n                email: null\r\n            },\r\n            userPasswordUpdateForm: {\r\n                originPassword: null,\r\n                newPassword: null,\r\n                confirmNewPassword: null\r\n            },\r\n            \r\n             userPasswordUpdateFormRule: {\r\n                originPassword: [\r\n                    { required: true,message: '请输入原密码', trigger: 'blur' },\r\n                ],\r\n                newPassword: [\r\n                    { required: true,message: '请输入新密码', trigger: 'blur'},\r\n                    { min: 6,max: 32,message: '密码在6~32位之间',trigger: 'blur'},\r\n                    { validator: validatePasswordIsEq, trigger: 'blur', required: true }\r\n                ],\r\n                confirmNewPassword: [\r\n                    { required: true,message: '请再次输入新密码', trigger: 'blur'},\r\n                    { min: 6,max: 32,message: '密码在6~32位之间',trigger: 'blur'},\r\n                    { validator: validatePasswordIsEq, trigger: 'blur'}\r\n                ]\r\n            },\r\n            isShowUpdatePasswordDialog: false,\r\n            isNickNameChanged: false,\r\n            userId: null\r\n        }\r\n    },\r\n\r\n    watch: {\r\n        'userFormData.nickname'(newVal) {\r\n            this.isNickNameChanged = this.$store.state.user.nickname != newVal\r\n        }\r\n    },\r\n    mounted() {\r\n        const data = user.loadUserLoginData()\r\n        this.userId = data.id\r\n        this.userFormData.nickname = this.$store.state.user.nickname\r\n        this.userFormData.username = data.username\r\n        this.userFormData.email = data.email\r\n    },\r\n\r\n    methods: {\r\n        onShowUpdatePasswordDialog() {\r\n            this.isShowUpdatePasswordDialog = true\r\n        },\r\n        onUpdatePasswordDialogClose(callback) {\r\n            this.userPasswordUpdateForm = {}\r\n            callback()\r\n        },\r\n        onUpdatePassword() {\r\n            this.$refs.userPasswordUpdateFormRef.validate(valid => {\r\n                if(valid) {\r\n                    updatePassword(this.userId, this.userPasswordUpdateForm).then(resp => {\r\n                        if (!resp.errCode) {\r\n                            this.$message.success(\"密码修改成功，请重新登录\")\r\n                            user.removeUserLoginData()\r\n                            this.isShowUpdatePasswordDialog = true\r\n                            this.userPasswordUpdateForm = {}\r\n                            this.$router.push({path: '/login'})\r\n                        }\r\n                    })\r\n                } else {\r\n                    this.$message.error('请检查表单项')\r\n                }\r\n            })\r\n        },\r\n        onUpdateNickname() {\r\n            if(!this.userFormData.nickname) {\r\n                this.$message.warning(\"请输入有效的昵称\")\r\n                return\r\n            }\r\n            updateNickname(this.userId, { nickname: this.userFormData.nickname }).then(resp => {\r\n                if (!resp.errCode) {\r\n                    this.$message.success(\"修改成功\")\r\n                    this.$store.commit('userUpdate', {\r\n                        nickname: this.userFormData.nickname\r\n                    })\r\n                }\r\n            })\r\n        },\r\n    }\r\n}\r\n</script>","import { render } from \"./UserProfile.vue?vue&type=template&id=2bbaea96\"\nimport script from \"./UserProfile.vue?vue&type=script&lang=js\"\nexport * from \"./UserProfile.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\git_workspace\\\\databasir-frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import axios from '@/utils/fetch';\r\n\r\nconst base = '/api/v1.0/users'\r\n\r\nexport const listUsers = (pageQuery) => {\r\n    return axios.get(base, {\r\n        params: pageQuery\r\n    })\r\n}\r\n\r\nexport const enableUser = (userId) => {\r\n    return axios.post(base+\"/\"+userId+\"/enable\")\r\n\r\n}\r\n\r\nexport const disableUser = (userId) => {\r\n    return axios.post(base+\"/\"+userId+\"/disable\")\r\n}\r\n\r\nexport const getByUserId = (userId) => {\r\n    return axios.get(base+\"/\"+userId)\r\n}\r\n\r\nexport const createUser = (request) => {\r\n    return axios.post(base, request)\r\n}\r\n\r\nexport const renewPassword = (id) => {\r\n    return axios.post(base +'/' + id +'/renew_password')\r\n}\r\n\r\nexport const addSysOwnerTo = (userId) => {\r\n    return axios.post(base +'/' + userId +'/sys_owners')\r\n}\r\n\r\nexport const removeSysOwnerFrom = (userId) => {\r\n    return axios.delete(base +'/' + userId +'/sys_owners')\r\n}\r\n\r\nexport const updatePassword = (userId, body) => {\r\n    return axios.post(base +'/' + userId +'/password', body)\r\n}\r\n\r\nexport const updateNickname = (userId, body) => {\r\n    return axios.post(base +'/' + userId +'/nickname', body)\r\n}","module.exports = __webpack_public_path__ + \"img/logo.bed2a90a.png\";"],"sourceRoot":""}