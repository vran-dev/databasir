{"version":3,"sources":["webpack:///./src/views/Document.vue","webpack:///./src/api/Document.js","webpack:///./src/views/Document.vue?22f9"],"names":["isShowNoDataPage","description","type","icon","round","size","onSyncProjectDocument","loading","state","loadings","handleSync","isShowLoadingPage","rows","init","class","gutter","span","style","groupId","onProjectDocumentVersionChange","databaseDocumentFilter","version","placeholder","clearable","databaseDocumentVersions","item","key","label","createAt","value","loadMoreDocumentVersions","loadingVersions","column","border","label-align","width","databaseDocument","databaseName","productName","productVersion","documentVersion","id","name","data","tables","prop","min-width","resizable","tableMeta","columns","length","fit","formatter","columnTypeFormat","indexes","triggers","content","placement","bottom","base","getOneByProjectId","proejctId","parameters","axios","get","params","syncByProjectId","post","getVersionByProjectId","setup","route","databaseDocumentVersionFilter","page","databaseDocumentVersionTotalPages","projectId","messageNotify","msg","showClose","message","duration","fetchDatabaseMetaData","versionResp","totalPages","resp","errCode","errMessage","decimalDigits","then","catch","debounce","forEach","element","push","fn","delay","timer","context","this","args","arguments","clearTimeout","setTimeout","apply","__exports__","render"],"mappings":"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","file":"js/chunk-2d0a47bb.baec3bc7.js","sourcesContent":["<template>\r\n  <div v-if=\"isShowNoDataPage\">\r\n      <el-empty description=\"似乎还没有同步过文档\" >\r\n          <el-button type=\"primary\" icon='refresh' round size='large' @click=\"onSyncProjectDocument\" :loading=\"state.loadings.handleSync\">同步</el-button>\r\n      </el-empty>\r\n  </div>\r\n  <div v-else-if=\"isShowLoadingPage\">\r\n    <el-skeleton v-loading=\"!state.init\" :rows=\"12\" />\r\n  </div>\r\n  <div v-else>\r\n    <el-container class=\"document-content\">\r\n      <el-header>\r\n          <el-row :gutter=\"20\">\r\n            <el-col :span=\"2\" v-require-roles=\"['SYS_OWNER', 'GROUP_OWNER?groupId='+state.groupId, 'GROUP_MEMBER?groupId='+state.groupId]\">\r\n              <el-button type=\"success\" style=\"width:100%\" icon=\"Refresh\" @click=\"onSyncProjectDocument\" :loading=\"state.loadings.handleSync\">同步</el-button>\r\n            </el-col>\r\n            <el-col :span=\"2\" v-require-roles=\"['SYS_OWNER', 'GROUP_OWNER?groupId='+state.groupId, 'GROUP_MEMBER?groupId='+state.groupId]\">\r\n                <el-button type=\"primary\" style=\"width:100%\" icon=\"Download\">导出</el-button>\r\n            </el-col>\r\n            <el-col :span=\"4\">\r\n                <el-select @change=\"onProjectDocumentVersionChange\" v-model=\"state.databaseDocumentFilter.version\" placeholder=\"历史版本\" v-select-more=\"loadMoreDocumentVersions\" v-loading=\"state.loadings.loadingVersions\" clearable>\r\n                  <el-option\r\n                  v-for=\"item in state.databaseDocumentVersions\"\r\n                  :key=\"item.version\"\r\n                  :label=\"'['+item.createAt +']->'+item.version+''\"\r\n                  :value=\"item.version\"\r\n                  >\r\n                  </el-option>\r\n              </el-select>\r\n            </el-col>\r\n          </el-row>\r\n      </el-header>\r\n      \r\n      <el-main>\r\n        <el-row>\r\n          <!-- database overview -->\r\n          <el-col>\r\n            <el-descriptions :column=\"1\" size=\"large\" border>\r\n              <el-descriptions-item label=\"Database Name\" label-align=\"left\" width='200px'>{{ state.databaseDocument.databaseName }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Product Name\" label-align=\"left\">{{ state.databaseDocument.productName }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Product Version\" label-align=\"left\">{{ state.databaseDocument.productVersion }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Document Version\" label-align=\"left\">{{ state.databaseDocument.documentVersion }}</el-descriptions-item>\r\n              <el-descriptions-item label=\"Create At\" label-align=\"left\">{{ state.databaseDocument.createAt }}</el-descriptions-item>\r\n            </el-descriptions>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- table overview -->\r\n        <el-row>\r\n          <el-col>\r\n            <h2 :id=\"state.databaseDocument.name + '.overview'\">Overview</h2>\r\n          </el-col>\r\n        </el-row>\r\n        <el-row>\r\n          <el-col>\r\n            <el-table :data=\"state.databaseDocument.tables\"  border width='80%'>\r\n              <el-table-column type=\"index\" />\r\n              <el-table-column prop=\"name\" label=\"Name\" min-width=\"160\" resizable />\r\n              <el-table-column prop=\"type\" label=\"Type\" width=\"200\"  resizable />\r\n              <el-table-column prop=\"comment\" label=\"comment\" min-width=\"160\" resizable />\r\n            </el-table>\r\n          </el-col>\r\n        </el-row>\r\n\r\n        <!-- table details -->\r\n        <template v-for=\"tableMeta in state.databaseDocument.tables\" :key=\"tableMeta\">\r\n          <el-row>\r\n            <el-col>\r\n              <h2 :id=\"state.databaseDocument.name + '.' + tableMeta.name\">{{ tableMeta.name }}</h2>\r\n            </el-col>\r\n          </el-row>\r\n          \r\n          <el-row>\r\n            <el-col v-if=\"tableMeta.columns.length > 0\">\r\n              <h3>Columns</h3>\r\n            </el-col>\r\n          </el-row>\r\n          <el-row>\r\n            <el-col >\r\n              <el-table :data=\"tableMeta.columns\" border fit width='80%'>\r\n                <el-table-column type=\"index\" />\r\n                <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                <el-table-column prop=\"type\" :formatter=\"columnTypeFormat\" label=\"Type\" width=\"140\" />\r\n                <el-table-column prop=\"nullable\" label=\"Is Nullable\" width=\"120\" />\r\n                <el-table-column prop=\"autoIncrement\" label=\"Auto increment\" width=\"140\" />\r\n                <el-table-column prop=\"defaultValue\" label=\"default\" min-width=\"120\" />\r\n                <el-table-column prop=\"comment\" label=\"comment\"  />\r\n              </el-table>\r\n            </el-col>\r\n          </el-row>\r\n        \r\n          <div v-if=\"tableMeta.indexes.length > 0\">\r\n            <el-row>\r\n              <el-col>\r\n                <h3>Indexes</h3>            \r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-col >\r\n                <el-table :data=\"tableMeta.indexes\" border fit width='80%'>\r\n                  <el-table-column type=\"index\" />\r\n                  <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                  <el-table-column prop=\"isPrimary\" label=\"IsPrimary\" width=\"120\" />\r\n                  <el-table-column prop=\"isUnique\" label=\"Is Unique\" width=\"120\" />\r\n                  <el-table-column prop=\"columnNames\" label=\"Columns\" min-width=\"150\" />\r\n                </el-table>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n \r\n          \r\n          <div  v-if=\"tableMeta.triggers.length > 0\">\r\n            <el-row>\r\n              <el-col>\r\n                <h3>Triggers</h3>\r\n              </el-col>\r\n            </el-row>\r\n            <el-row>\r\n              <el-col >\r\n                <el-table :data=\"tableMeta.triggers\" fit border width='80%'>\r\n                  <el-table-column type=\"index\" />\r\n                  <el-table-column prop=\"name\" label=\"Name\" min-width=\"120\" />\r\n                  <el-table-column prop=\"timing\" label=\"timing\" />\r\n                  <el-table-column prop=\"manipulation\" label=\"manipulation\" width=\"120\" />\r\n                  <el-table-column prop=\"statement\" label=\"statement\" />\r\n                  <el-table-column prop=\"creatAt\" label=\"creatAt\" width=\"150\" />\r\n                </el-table>\r\n              </el-col>\r\n            </el-row>\r\n          </div>\r\n\r\n        </template>\r\n        <el-tooltip\r\n          content=\"回到顶部\"\r\n          placement=\"top\"\r\n        >\r\n          <el-backtop :bottom=\"100\"></el-backtop>\r\n        </el-tooltip>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { reactive, computed } from 'vue'\r\nimport {  useRoute } from 'vue-router'\r\nimport { getOneByProjectId, syncByProjectId, getVersionByProjectId } from '@/api/Document'\r\nimport { ElMessage } from 'element-plus'\r\n\r\nexport default {\r\n  setup() {\r\n    const route = useRoute()\r\n    const state = reactive({\r\n      databaseDocumentVersionFilter: {\r\n        page: 0,\r\n        size: 10,\r\n      },\r\n      databaseDocumentVersions: [],\r\n      databaseDocumentVersionTotalPages: 0,\r\n\r\n      databaseDocumentFilter: {\r\n        version: null\r\n      },\r\n      databaseDocument: null,\r\n      init: false,\r\n      loadings: {\r\n        handleSync: false,\r\n        loadingVersions: false\r\n      },\r\n      projectId: null,\r\n      groupId: null\r\n    })\r\n\r\n    state.projectId = route.params.projectId\r\n    state.groupId = route.params.groupId\r\n    const isShowNoDataPage = computed(() => !state.databaseDocument && state.init)\r\n    const isShowLoadingPage = computed(() => !state.databaseDocument && !state.init)\r\n\r\n    const messageNotify = (type, msg) => {\r\n      ElMessage({\r\n            showClose: true,\r\n            message: msg,\r\n            type: type,\r\n            duration: 3 * 1000\r\n        });\r\n    }\r\n\r\n    const fetchDatabaseMetaData = async () => {\r\n      // fetch version\r\n      const versionResp = await getVersionByProjectId(route.params.projectId)\r\n      state.databaseDocumentVersions = versionResp.data.content\r\n      state.databaseDocumentVersionTotalPages = versionResp.data.totalPages\r\n\r\n      // fetch meta\r\n      const resp = await getOneByProjectId(route.params.projectId)\r\n      if (resp.errCode) {\r\n        messageNotify('error', '同步失败：'+resp.errMessage)\r\n      } else if (resp.data) {\r\n        state.databaseDocument = resp.data\r\n      } else {\r\n        messageNotify('warn', '无可用数据')\r\n      }\r\n      state.init = true\r\n    }\r\n\r\n\r\n    const columnTypeFormat = (column) => {\r\n      if (column.decimalDigits == null) {\r\n        return column.type + '('+column.size+')' \r\n      } else {\r\n        return column.type + '('+column.size+', '+column.decimalDigits+')'\r\n      }\r\n    }\r\n\r\n    const onProjectDocumentVersionChange = async () => {\r\n      const resp =  await getOneByProjectId(route.params.projectId, state.databaseDocumentFilter)\r\n      if (resp.data) {\r\n        state.databaseDocument = resp.data\r\n        messageNotify('success', '切换成功')\r\n      } else {\r\n        messageNotify('warn', '无可用数据')\r\n      }\r\n    }\r\n\r\n    const onSyncProjectDocument = () => {\r\n      const projectId = route.params.projectId\r\n      state.loadings.handleSync = true\r\n      syncByProjectId(projectId)\r\n      .then(resp => {\r\n        if (!resp.errCode) {\r\n          fetchDatabaseMetaData()\r\n          messageNotify('success', '同步成功')\r\n        }\r\n        state.loadings.handleSync = false\r\n      })\r\n      .catch(() => state.loadings.handleSync = false)\r\n    }\r\n\r\n    const loadMoreDocumentVersions = debounce(async () => {\r\n        state.loadings.loadingVersions = true\r\n        if (state.databaseDocumentVersionFilter.page + 1  < state.databaseDocumentVersionTotalPages) {\r\n          state.databaseDocumentVersionFilter.page++\r\n          const versionResp = await  getVersionByProjectId(route.params.projectId, state.databaseDocumentVersionFilter)\r\n          state.databaseDocumentVersionTotalPages = versionResp.data.totalPages\r\n          if (versionResp.data.content.length > 0){\r\n            versionResp.data.content.forEach(element => state.databaseDocumentVersions.push(element))\r\n          }\r\n        }\r\n        state.loadings.loadingVersions = false\r\n    }, 800)\r\n\r\n    // 节流\r\n    function debounce(fn, delay) {\r\n      let timer = null\r\n      return function () {\r\n        let context = this\r\n        let args = arguments\r\n        if(timer) {\r\n            clearTimeout(timer)\r\n        }\r\n        timer = setTimeout(function () {\r\n          fn.apply(context, args)\r\n        }, delay)\r\n      }\r\n    }\r\n\r\n    fetchDatabaseMetaData()\r\n\r\n    return {\r\n      state,\r\n      isShowNoDataPage,\r\n      isShowLoadingPage,\r\n      columnTypeFormat,\r\n      loadMoreDocumentVersions,\r\n      onProjectDocumentVersionChange,\r\n      onSyncProjectDocument\r\n    }\r\n  }\r\n}\r\n\r\n</script>","import axios from '@/utils/fetch';\r\n\r\nconst base = '/api/v1.0'\r\n\r\nexport const getOneByProjectId = (proejctId, parameters) => {\r\n    return axios.get(base + '/projects/'+proejctId+'/documents', {\r\n        params: parameters\r\n    })\r\n}\r\n\r\nexport const syncByProjectId = (proejctId) => {\r\n    return axios.post(base + \"/projects/\"+proejctId+\"/documents\")\r\n}\r\n\r\nexport const getVersionByProjectId =(proejctId, parameters) => {\r\n    return axios.get(base + \"/projects/\"+proejctId+\"/document_versions\", {\r\n        params: parameters\r\n    })\r\n}\r\n","import { render } from \"./Document.vue?vue&type=template&id=3a5d2af6\"\nimport script from \"./Document.vue?vue&type=script&lang=js\"\nexport * from \"./Document.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"E:\\\\git_workspace\\\\databasir-frontend\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}