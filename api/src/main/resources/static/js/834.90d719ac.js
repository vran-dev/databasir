"use strict";(self["webpackChunkdatabasir"]=self["webpackChunkdatabasir"]||[]).push([[834],{38787:function(e,a,t){t.d(a,{aF:function(){return o},nK:function(){return r},Hj:function(){return n},Jp:function(){return i},FO:function(){return m},ri:function(){return d},KT:function(){return s}});var l=t(63872);const p="/oauth2",o=()=>l.Z.get(p+"/apps"),r=(e,a)=>l.Z.get(p+"/authorization/"+e,{params:a}),u="/api/v1.0/oauth2_apps",n=e=>l.Z.get(u,{params:e}),i=e=>l.Z["delete"](u+"/"+e),m=e=>l.Z.get(u+"/"+e),d=e=>l.Z.post(u,e),s=e=>l.Z.patch(u,e)},1082:function(e,a,t){t.d(a,{Z:function(){return d}});var l=t(66252),p=t(3577);const o=["src"],r=["src"];function u(e,a,u,n,i,m){const d=(0,l.up)("el-tooltip");return"github"==u.appType.toLowerCase()?((0,l.wg)(),(0,l.j4)(d,{key:0,content:u.appName,effect:"light"},{default:(0,l.w5)((()=>[(0,l._)("img",{src:u.appIcon?u.appIcon:t(39710),style:{"max-width":"20px","max-height":"20px"}},null,8,o)])),_:1},8,["content"])):"gitlab"==u.appType.toLowerCase()?((0,l.wg)(),(0,l.j4)(d,{key:1,content:u.appName,effect:"light"},{default:(0,l.w5)((()=>[(0,l._)("img",{src:u.appIcon?u.appIcon:t(84386),style:{"max-width":"20px","max-height":"20px"}},null,8,r)])),_:1},8,["content"])):((0,l.wg)(),(0,l.iD)(l.HY,{key:2},[(0,l.Uk)((0,p.zw)(u.appType),1)],64))}var n={props:{appType:String,appIcon:String,appName:String}},i=t(83744);const m=(0,i.Z)(n,[["render",u]]);var d=m},86834:function(e,a,t){t.r(a),t.d(a,{default:function(){return k}});var l=t(66252),p=t(3577);const o={style:{"margin-left":"12px"}},r=(0,l.Uk)(" 应用 ID "),u=(0,l.Uk)(" 应用类型 "),n=(0,l.Uk)(" clientId "),i=(0,l.Uk)(" 资源地址 "),m=(0,l.Uk)(" 授权地址 "),d=(0,l.Uk)(" 创建时间 "),s={style:{"margin-top":"20px"}},g=(0,l.Uk)(" 编辑 "),c=(0,l.Uk)(" 删除 "),w=(0,l.Uk)("保存"),f=(0,l.Uk)("取消");function h(e,a,t,h,W,_){const y=(0,l.up)("el-button"),D=(0,l.up)("el-tooltip"),b=(0,l.up)("el-col"),k=(0,l.up)("el-input"),U=(0,l.up)("el-option"),C=(0,l.up)("el-select"),P=(0,l.up)("el-divider"),x=(0,l.up)("el-row"),F=(0,l.up)("oauth2-app-type"),V=(0,l.up)("top-right"),A=(0,l.up)("el-icon"),I=(0,l.up)("el-descriptions-item"),z=(0,l.up)("el-tag"),T=(0,l.up)("tickets"),v=(0,l.up)("Link"),S=(0,l.up)("el-link"),E=(0,l.up)("clock"),N=(0,l.up)("el-descriptions"),Q=(0,l.up)("el-space"),Z=(0,l.up)("el-card"),j=(0,l.up)("el-empty"),q=(0,l.up)("el-form-item"),H=(0,l.up)("info-filled"),K=(0,l.up)("el-form"),$=(0,l.up)("el-dialog"),O=(0,l.up)("el-main"),R=(0,l.up)("el-pagination"),B=(0,l.up)("el-footer"),L=(0,l.up)("el-container");return(0,l.wg)(),(0,l.j4)(L,null,{default:(0,l.w5)((()=>[(0,l.Wm)(O,null,{default:(0,l.w5)((()=>[(0,l.Wm)(x,{gutter:12},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{xs:24,sm:6,md:6,lg:3,xl:3},{default:(0,l.w5)((()=>[(0,l.Wm)(D,{content:"创建应用",placement:"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{type:"primary",icon:"plus",style:{width:"100%"},onClick:a[0]||(a[0]=e=>_.onAppCreate())})])),_:1})])),_:1}),(0,l.Wm)(b,{xs:24,sm:10,md:10,lg:6,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{onChange:_.onQuery,modelValue:W.appPageQuery.appNameContains,"onUpdate:modelValue":a[1]||(a[1]=e=>W.appPageQuery.appNameContains=e),label:"应用名称",placeholder:"应用名称搜素","prefix-icon":"search"},null,8,["onChange","modelValue"])])),_:1}),(0,l.Wm)(b,{xs:24,sm:8,md:8,lg:6,xl:4},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{modelValue:W.appPageQuery.appType,"onUpdate:modelValue":a[2]||(a[2]=e=>W.appPageQuery.appType=e),placeholder:"应用类型",onChange:_.onQuery,clearable:"",style:{width:"100%"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(W.appTypes,(e=>((0,l.wg)(),(0,l.j4)(U,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1}),(0,l.Wm)(b,{span:24},{default:(0,l.w5)((()=>[(0,l.Wm)(P)])),_:1})])),_:1}),(0,l.Wm)(x,{gutter:33},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(W.appPageData.data,(a=>((0,l.wg)(),(0,l.j4)(b,{xs:24,sm:24,md:12,lg:8,xl:6,key:a.id},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{shadow:"hover"},{default:(0,l.w5)((()=>[(0,l.Wm)(P,{"content-position":"left"},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{"app-type":a.appType,"app-name":a.appName},null,8,["app-type","app-name"]),(0,l._)("span",o,(0,p.zw)(a.appName),1)])),_:2},1024),(0,l._)("div",null,[(0,l.Wm)(N,{column:1,size:e.size,border:""},{default:(0,l.w5)((()=>[(0,l.Wm)(I,{label:"appId"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(V)])),_:1}),r])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,p.zw)(a.registrationId),1)])),_:2},1024),(0,l.Wm)(I,{label:"appType"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(V)])),_:1}),u])),default:(0,l.w5)((()=>[(0,l.Wm)(z,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,p.zw)(a.appType),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(I,{label:"clientId"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(T)])),_:1}),n])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,p.zw)(a.clientId),1)])),_:2},1024),(0,l.Wm)(I,{label:"资源地址"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),i])),default:(0,l.w5)((()=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,p.zw)(a.authUrl),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(I,{label:"授权地址"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v)])),_:1}),m])),default:(0,l.w5)((()=>[(0,l.Wm)(S,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,p.zw)(a.resourceUrl),1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(I,{label:"创建时间"},{label:(0,l.w5)((()=>[(0,l.Wm)(A,null,{default:(0,l.w5)((()=>[(0,l.Wm)(E)])),_:1}),d])),default:(0,l.w5)((()=>[(0,l.Uk)(" "+(0,p.zw)(a.createAt),1)])),_:2},1024)])),_:2},1032,["size"])]),(0,l._)("div",s,[(0,l.Wm)(Q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{type:"primary",size:"small",icon:"Edit",onClick:e=>_.onAppEdit(a)},{default:(0,l.w5)((()=>[g])),_:2},1032,["onClick"]),(0,l.Wm)(y,{type:"danger",onClick:e=>_.onDelete(a),size:"small",icon:"Delete"},{default:(0,l.w5)((()=>[c])),_:2},1032,["onClick"])])),_:2},1024)])])),_:2},1024)])),_:2},1024)))),128))])),_:1}),0==W.appPageData.data.length?((0,l.wg)(),(0,l.j4)(j,{key:0,"image-size":200,description:"暂无数据"})):(0,l.kq)("",!0),(0,l.Wm)($,{modelValue:W.isShowEditAppDialog,"onUpdate:modelValue":a[12]||(a[12]=e=>W.isShowEditAppDialog=e),width:"38%",center:"","destroy-on-close":""},{default:(0,l.w5)((()=>[(0,l.Wm)(K,{model:W.appFormData,rules:W.appFormDataRule,ref:"appFormDataRef","label-position":"top"},{default:(0,l.w5)((()=>[(0,l.Wm)(x,{gutter:28},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"应用 ID",prop:"registrationId"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.registrationId,"onUpdate:modelValue":a[3]||(a[3]=e=>W.appFormData.registrationId=e),placeholder:"建议输入全英文字符"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"应用名称",prop:"appName"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.appName,"onUpdate:modelValue":a[4]||(a[4]=e=>W.appFormData.appName=e),placeholder:"用户可理解的登陆应用名"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(q,{label:"应用类型",prop:"appName"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{modelValue:W.appFormData.appType,"onUpdate:modelValue":a[5]||(a[5]=e=>W.appFormData.appType=e),placeholder:"请选择应用类型",size:"default"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(W.appTypes,(e=>((0,l.wg)(),(0,l.j4)(U,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(x,{gutter:28},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"Client Id",prop:"clientId"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.clientId,"onUpdate:modelValue":a[6]||(a[6]=e=>W.appFormData.clientId=e),placeholder:"Oauth2 平台下发的 clientId"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"Client Secret",prop:"clientSecret"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.clientSecret,"onUpdate:modelValue":a[7]||(a[7]=e=>W.appFormData.clientSecret=e),placeholder:"Oauth2 平台下发的秘钥"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(x,{gutter:28},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"授权地址",prop:"authUrl"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.authUrl,"onUpdate:modelValue":a[8]||(a[8]=e=>W.appFormData.authUrl=e),placeholder:"用于获取 access token 的服务地址"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(b,{xs:24,sm:24,md:12,lg:10},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"资源地址",prop:"resourceUrl"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:W.appFormData.resourceUrl,"onUpdate:modelValue":a[9]||(a[9]=e=>W.appFormData.resourceUrl=e),placeholder:"用于获取用户信息的服务地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(x,{style:{"margin-bottom":"33px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(b,null,{default:(0,l.w5)((()=>[(0,l.Wm)(P,null,{default:(0,l.w5)((()=>[(0,l.Wm)(A,{color:"#000"},{default:(0,l.w5)((()=>[(0,l.Wm)(H)])),_:1}),(0,l.Uk)(" 请在 "+(0,p.zw)(W.appFormData.appType)+" 中配置回调地址 ",1)])),_:1}),(0,l.Wm)(S,{type:"primary"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,p.zw)(W.redirectUri)+(0,p.zw)(W.appFormData.registrationId),1)])),_:1})])),_:1})])),_:1}),(0,l.Wm)(q,null,{default:(0,l.w5)((()=>[(0,l.Wm)(y,{type:"primary",onClick:a[10]||(a[10]=e=>_.onAppSave("groupFormRef"))},{default:(0,l.w5)((()=>[w])),_:1}),(0,l.Wm)(y,{onClick:a[11]||(a[11]=e=>W.isShowEditAppDialog=!1)},{default:(0,l.w5)((()=>[f])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])),_:1}),(0,l.Wm)(B,null,{default:(0,l.w5)((()=>[(0,l.Wm)(R,{layout:"prev, pager, next","hide-on-single-page":!1,currentPage:W.appPageData.number,"page-size":W.appPageData.size,"page-count":W.appPageData.totalPages,onCurrentChange:_.onAppCurrentPageChange},null,8,["currentPage","page-size","page-count","onCurrentChange"])])),_:1})])),_:1})}var W=t(38787),_=t(1082),y={components:{Oauth2AppType:_.Z},data(){return{appPageData:{data:[],number:1,size:10,totalElements:0,totalPages:0},appPageQuery:{page:0,size:10,appNameContains:null,appType:null},isShowEditAppDialog:!1,redirectUri:"",appFormData:{id:null},appFormDataRule:{registrationId:[{required:!0,message:"请为应用配置唯一 ID",trigger:"blur"}],appName:[{required:!0,message:"请输入应用名称",trigger:"blur"}],appType:[{required:!0,message:"请选择应用类型",trigger:"blur"}],authUrl:[{required:!0,message:"请配置请求授权地址",trigger:"blur"}],resourceUrl:[{required:!0,message:"请配置资源 API 地址",trigger:"blur"}],clientId:[{required:!0,message:"请配置申请的 clientId",trigger:"blur"}],clientSecret:[{required:!0,message:"请配置申请的 clientSecret",trigger:"blur"}]},appTypes:["GITLAB","GITHUB"]}},created(){this.redirectUri=window.location.protocol+"//"+window.location.host+"/login/oauth2/",this.onAppCurrentPageChange(1)},methods:{fetchApps(e){e&&(this.appPageQuery.page=e-1),""==this.appPageQuery.appType&&(this.appPageQuery.appType=null),(0,W.Hj)(this.appPageQuery).then((e=>{e.errCode||(this.appPageData.data=e.data.content,this.appPageData.number=e.data.number+1,this.appPageData.size=e.data.size,this.appPageData.totalPages=e.data.totalPages,this.appPageData.totalElements=e.data.totalElements)}))},onAppCurrentPageChange(e){e&&this.fetchApps(e-1)},onQuery(){this.fetchApps()},onAppEdit(e){(0,W.FO)(e.id).then((e=>{e.errCode||(this.appFormData=e.data,this.isShowEditAppDialog=!0)}))},onAppCreate(){this.appFormData={},this.isShowEditAppDialog=!0},onDelete(e){this.$confirm("确认删除该 APP 登录方式吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,W.Jp)(e.id).then((e=>{e.errCode||(this.$message.success("删除成功"),this.fetchApps())}))}))},onAppSave(){this.$refs.appFormDataRef.validate((e=>{e?this.appFormData.id?(0,W.KT)(this.appFormData).then((e=>{e.errCode||(this.$message.success("更新成功"),this.isShowEditAppDialog=!1,this.fetchApps())})):(0,W.ri)(this.appFormData).then((e=>{e.errCode||(this.$message.success("创建成功"),this.isShowEditAppDialog=!1,this.fetchApps())})):this.$message.error("请填写表单必填项")}))}}},D=t(83744);const b=(0,D.Z)(y,[["render",h]]);var k=b},39710:function(e,a,t){e.exports=t.p+"img/github.e45f4724.svg"},84386:function(e,a,t){e.exports=t.p+"img/gitlab.6b1155ee.svg"}}]);
//# sourceMappingURL=834.90d719ac.js.map