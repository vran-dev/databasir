"use strict";(self["webpackChunkdatabasir"]=self["webpackChunkdatabasir"]||[]).push([[754],{8787:function(e,t,a){a.d(t,{aF:function(){return u},nK:function(){return p},Hj:function(){return l},Jp:function(){return i},FO:function(){return c},ri:function(){return f},KT:function(){return d}});var n=a(3872),r="/oauth2",u=function(){return n.Z.get(r+"/apps")},p=function(e,t){return n.Z.get(r+"/authorization/"+e,{params:t})},o="/api/v1.0/oauth2_apps",l=function(e){return n.Z.get(o,{params:e})},i=function(e){return n.Z["delete"](o+"/"+e)},c=function(e){return n.Z.get(o+"/"+e)},f=function(e){return n.Z.post(o,e)},d=function(e){return n.Z.patch(o,e)}},1082:function(e,t,a){a.d(t,{Z:function(){return f}});var n=a(6252),r=a(3577),u=["src"],p=["src"];function o(e,t,o,l,i,c){var f=(0,n.up)("el-tooltip");return"github"==o.appType.toLowerCase()?((0,n.wg)(),(0,n.j4)(f,{key:0,content:o.appName,effect:"light"},{default:(0,n.w5)((function(){return[(0,n._)("img",{src:o.appIcon?o.appIcon:a(9710),style:{"max-width":"20px","max-height":"20px"}},null,8,u)]})),_:1},8,["content"])):"gitlab"==o.appType.toLowerCase()?((0,n.wg)(),(0,n.j4)(f,{key:1,content:o.appName,effect:"light"},{default:(0,n.w5)((function(){return[(0,n._)("img",{src:o.appIcon?o.appIcon:a(4386),style:{"max-width":"20px","max-height":"20px"}},null,8,p)]})),_:1},8,["content"])):((0,n.wg)(),(0,n.iD)(n.HY,{key:2},[(0,n.Uk)((0,r.zw)(o.appType),1)],64))}var l={props:{appType:String,appIcon:String,appName:String}},i=a(3744);const c=(0,i.Z)(l,[["render",o]]);var f=c},7754:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var n=a(6252),r=a(3577),u=(0,n.Uk)(" 编辑 "),p=(0,n.Uk)(" 删除 "),o=(0,n.Uk)("保存"),l=(0,n.Uk)("取消");function i(e,t,a,i,c,f){var d=(0,n.up)("el-button"),m=(0,n.up)("el-tooltip"),s=(0,n.up)("el-col"),g=(0,n.up)("el-input"),w=(0,n.up)("el-option"),h=(0,n.up)("el-select"),W=(0,n.up)("el-row"),y=(0,n.up)("el-header"),D=(0,n.up)("el-table-column"),_=(0,n.up)("oauth2-app-type"),b=(0,n.up)("el-link"),C=(0,n.up)("el-space"),U=(0,n.up)("el-table"),P=(0,n.up)("el-form-item"),F=(0,n.up)("info-filled"),V=(0,n.up)("el-icon"),A=(0,n.up)("el-divider"),k=(0,n.up)("el-form"),I=(0,n.up)("el-dialog"),T=(0,n.up)("el-main"),v=(0,n.up)("el-pagination"),S=(0,n.up)("el-footer"),z=(0,n.up)("el-container");return(0,n.wg)(),(0,n.j4)(z,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(y,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(W,{gutter:12},{default:(0,n.w5)((function(){return[(0,n.Wm)(s,{span:2},{default:(0,n.w5)((function(){return[(0,n.Wm)(m,{content:"创建应用",placement:"top"},{default:(0,n.w5)((function(){return[(0,n.Wm)(d,{type:"primary",icon:"plus",style:{width:"100%"},onClick:t[0]||(t[0]=function(e){return f.onAppCreate()})})]})),_:1})]})),_:1}),(0,n.Wm)(s,{span:6},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{onChange:f.onQuery,modelValue:c.appPageQuery.appNameContains,"onUpdate:modelValue":t[1]||(t[1]=function(e){return c.appPageQuery.appNameContains=e}),label:"应用名称",placeholder:"应用名称搜素","prefix-icon":"search"},null,8,["onChange","modelValue"])]})),_:1}),(0,n.Wm)(s,{span:3},{default:(0,n.w5)((function(){return[(0,n.Wm)(h,{modelValue:c.appPageQuery.appType,"onUpdate:modelValue":t[2]||(t[2]=function(e){return c.appPageQuery.appType=e}),placeholder:"应用类型",onChange:f.onQuery,clearable:""},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.appTypes,(function(e){return(0,n.wg)(),(0,n.j4)(w,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(T,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(U,{data:c.appPageData.data},{default:(0,n.w5)((function(){return[(0,n.Wm)(D,{prop:"registrationId",label:"应用 ID"}),(0,n.Wm)(D,{prop:"appType",label:"应用类型"},{default:(0,n.w5)((function(e){return[(0,n.Wm)(_,{"app-type":e.row.appType,"app-name":e.row.appName},null,8,["app-type","app-name"]),(0,n.Uk)(" "+(0,r.zw)(e.row.appType),1)]})),_:1}),(0,n.Wm)(D,{prop:"appName",label:"名称"}),(0,n.Wm)(D,{label:"授权地址"},{default:(0,n.w5)((function(e){return[(0,n.Wm)(b,{type:"info"},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,r.zw)(e.row.authUrl),1)]})),_:2},1024)]})),_:1}),(0,n.Wm)(D,{label:"资源地址"},{default:(0,n.w5)((function(e){return[(0,n.Wm)(b,{type:"info"},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,r.zw)(e.row.resourceUrl),1)]})),_:2},1024)]})),_:1}),(0,n.Wm)(D,{prop:"clientId",label:"Client ID"}),(0,n.Wm)(D,{prop:"updateAt",label:"更新时间"}),(0,n.Wm)(D,{prop:"createAt",label:"创建时间"}),(0,n.Wm)(D,{label:"操作"},{default:(0,n.w5)((function(e){return[(0,n.Wm)(C,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(d,{type:"primary",size:"small",icon:"Edit",onClick:function(t){return f.onAppEdit(e.row)}},{default:(0,n.w5)((function(){return[u]})),_:2},1032,["onClick"]),(0,n.Wm)(d,{type:"danger",onClick:function(t){return f.onDelete(e.row)},size:"small",icon:"Delete"},{default:(0,n.w5)((function(){return[p]})),_:2},1032,["onClick"])]})),_:2},1024)]})),_:1})]})),_:1},8,["data"]),(0,n.Wm)(I,{modelValue:c.isShowEditAppDialog,"onUpdate:modelValue":t[12]||(t[12]=function(e){return c.isShowEditAppDialog=e}),width:"38%",center:"","destroy-on-close":""},{default:(0,n.w5)((function(){return[(0,n.Wm)(k,{model:c.appFormData,rules:c.appFormDataRule,ref:"appFormDataRef","label-position":"top"},{default:(0,n.w5)((function(){return[(0,n.Wm)(W,{gutter:28},{default:(0,n.w5)((function(){return[(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"应用 ID",prop:"registrationId"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.registrationId,"onUpdate:modelValue":t[3]||(t[3]=function(e){return c.appFormData.registrationId=e}),placeholder:"建议输入全英文字符"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"应用名称",prop:"appName"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.appName,"onUpdate:modelValue":t[4]||(t[4]=function(e){return c.appFormData.appName=e}),placeholder:"用户可理解的登陆应用名"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(P,{label:"应用类型",prop:"appName"},{default:(0,n.w5)((function(){return[(0,n.Wm)(h,{modelValue:c.appFormData.appType,"onUpdate:modelValue":t[5]||(t[5]=function(e){return c.appFormData.appType=e}),placeholder:"请选择应用类型",size:"default"},{default:(0,n.w5)((function(){return[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(c.appTypes,(function(e){return(0,n.wg)(),(0,n.j4)(w,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),(0,n.Wm)(W,{gutter:28},{default:(0,n.w5)((function(){return[(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"Client Id",prop:"clientId"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.clientId,"onUpdate:modelValue":t[6]||(t[6]=function(e){return c.appFormData.clientId=e}),placeholder:"Oauth2 平台下发的 clientId"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"Client Secret",prop:"clientSecret"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.clientSecret,"onUpdate:modelValue":t[7]||(t[7]=function(e){return c.appFormData.clientSecret=e}),placeholder:"Oauth2 平台下发的秘钥"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(W,{gutter:28},{default:(0,n.w5)((function(){return[(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"授权地址",prop:"authUrl"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.authUrl,"onUpdate:modelValue":t[8]||(t[8]=function(e){return c.appFormData.authUrl=e}),placeholder:"用于获取 access token 的服务地址"},null,8,["modelValue"])]})),_:1})]})),_:1}),(0,n.Wm)(s,{span:10},{default:(0,n.w5)((function(){return[(0,n.Wm)(P,{label:"资源地址",prop:"resourceUrl"},{default:(0,n.w5)((function(){return[(0,n.Wm)(g,{modelValue:c.appFormData.resourceUrl,"onUpdate:modelValue":t[9]||(t[9]=function(e){return c.appFormData.resourceUrl=e}),placeholder:"用于获取用户信息的服务地址"},null,8,["modelValue"])]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(W,{style:{"margin-bottom":"33px"}},{default:(0,n.w5)((function(){return[(0,n.Wm)(s,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(A,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(V,{color:"#000"},{default:(0,n.w5)((function(){return[(0,n.Wm)(F)]})),_:1}),(0,n.Uk)(" 请在 "+(0,r.zw)(c.appFormData.appType)+" 中配置回调地址 ",1)]})),_:1}),(0,n.Wm)(b,{type:"primary"},{default:(0,n.w5)((function(){return[(0,n.Uk)((0,r.zw)(c.redirectUri)+(0,r.zw)(c.appFormData.registrationId),1)]})),_:1})]})),_:1})]})),_:1}),(0,n.Wm)(P,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(d,{type:"primary",onClick:t[10]||(t[10]=function(e){return f.onAppSave("groupFormRef")})},{default:(0,n.w5)((function(){return[o]})),_:1}),(0,n.Wm)(d,{onClick:t[11]||(t[11]=function(e){return c.isShowEditAppDialog=!1})},{default:(0,n.w5)((function(){return[l]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:1},8,["modelValue"])]})),_:1}),(0,n.Wm)(S,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(v,{layout:"prev, pager, next","hide-on-single-page":!1,currentPage:c.appPageData.number,"page-size":c.appPageData.size,"page-count":c.appPageData.totalPages,onCurrentChange:f.onAppCurrentPageChange},null,8,["currentPage","page-size","page-count","onCurrentChange"])]})),_:1})]})),_:1})}var c=a(8787),f=a(1082),d={components:{Oauth2AppType:f.Z},data:function(){return{appPageData:{data:[],number:1,size:10,totalElements:0,totalPages:1},appPageQuery:{page:0,size:10,appNameContains:null,appType:null},isShowEditAppDialog:!1,redirectUri:"",appFormData:{id:null},appFormDataRule:{registrationId:[{required:!0,message:"请为应用配置唯一 ID",trigger:"blur"}],appName:[{required:!0,message:"请输入应用名称",trigger:"blur"}],appType:[{required:!0,message:"请选择应用类型",trigger:"blur"}],authUrl:[{required:!0,message:"请配置请求授权地址",trigger:"blur"}],resourceUrl:[{required:!0,message:"请配置资源 API 地址",trigger:"blur"}],clientId:[{required:!0,message:"请配置申请的 clientId",trigger:"blur"}],clientSecret:[{required:!0,message:"请配置申请的 clientSecret",trigger:"blur"}]},appTypes:["GITLAB","GITHUB"]}},created:function(){this.redirectUri=window.location.protocol+"//"+window.location.host+"/login/oauth2/",this.fetchApps()},methods:{fetchApps:function(e){var t=this;this.appPageQuery.page=e?e-1:null,""==this.appPageQuery.appType&&(this.appPageQuery.appType=null),(0,c.Hj)(this.appPageQuery).then((function(e){e.errCode||(t.appPageData.data=e.data.content,t.appPageData.number=e.data.number+1,t.appPageData.size=e.data.size,t.appPageData.totalPages=e.data.totalPages,t.appPageData.totalElements=e.data.totalElements)}))},onAppCurrentPageChange:function(e){e&&e-1!=this.appPageQuery.page&&(this.appPageQuery.page=e-1,this.fetchApps(e))},onQuery:function(){this.fetchApps()},onAppEdit:function(e){var t=this;(0,c.FO)(e.id).then((function(e){e.errCode||(t.appFormData=e.data,t.isShowEditAppDialog=!0)}))},onAppCreate:function(){this.appFormData={},this.isShowEditAppDialog=!0},onDelete:function(e){var t=this;this.$confirm("确认删除该 APP 登录方式吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){(0,c.Jp)(e.id).then((function(e){e.errCode||(t.$message.success("删除成功"),t.fetchApps())}))}))},onAppSave:function(){var e=this;this.$refs.appFormDataRef.validate((function(t){t?e.appFormData.id?(0,c.KT)(e.appFormData).then((function(t){t.errCode||(e.$message.success("更新成功"),e.isShowEditAppDialog=!1,e.fetchApps())})):(0,c.ri)(e.appFormData).then((function(t){t.errCode||(e.$message.success("创建成功"),e.isShowEditAppDialog=!1,e.fetchApps())})):e.$message.error("请填写表单必填项")}))}}},m=a(3744);const s=(0,m.Z)(d,[["render",i]]);var g=s},9710:function(e,t,a){e.exports=a.p+"img/github.e45f4724.svg"},4386:function(e,t,a){e.exports=a.p+"img/gitlab.6b1155ee.svg"}}]);
//# sourceMappingURL=754-legacy.8ce78db0.js.map