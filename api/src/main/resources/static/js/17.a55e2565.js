"use strict";(self["webpackChunkdatabasir"]=self["webpackChunkdatabasir"]||[]).push([[17],{5430:function(e,a,t){t.d(a,{v:function(){return r}});var o=t(63872);const n="/api/v1.0/operation_logs",r=e=>o.Z.get(n,{params:e})},16017:function(e,a,t){t.r(a),t.d(a,{default:function(){return j}});var o=t(66252),n=t(3577);const r={key:0},l=(0,o.Uk)("成功"),u={key:1},i=(0,o.Uk)("失败"),p={key:0},g={key:1},s={key:1},c={key:1},d={key:1};function w(e,a,t,w,m,P){const h=(0,o.up)("el-table-column"),f=(0,o.up)("arrow-down"),j=(0,o.up)("el-icon"),L=(0,o.up)("el-dropdown-item"),k=(0,o.up)("el-dropdown-menu"),v=(0,o.up)("el-dropdown"),b=(0,o.up)("el-tag"),y=(0,o.up)("el-link"),O=(0,o.up)("el-table"),C=(0,o.up)("el-main"),W=(0,o.up)("el-pagination"),_=(0,o.up)("el-footer"),D=(0,o.up)("el-container");return(0,o.wg)(),(0,o.j4)(D,null,{default:(0,o.w5)((()=>[(0,o.Wm)(C,null,{default:(0,o.w5)((()=>[(0,o.Wm)(O,{data:m.projectOperationLogPageData.data},{default:(0,o.w5)((()=>[(0,o.Wm)(h,{prop:"id",label:""}),(0,o.Wm)(h,{prop:"operationModule",label:"系统模块"}),(0,o.Wm)(h,{prop:"operatorNickname",label:"操作人"}),(0,o.Wm)(h,{prop:"operationName",label:"操作"}),(0,o.Wm)(h,{label:"状态"},{header:(0,o.w5)((()=>[(0,o.Wm)(v,null,{dropdown:(0,o.w5)((()=>[(0,o.Wm)(k,null,{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(m.logStatusMap,((e,a)=>((0,o.wg)(),(0,o.j4)(L,{key:a,onClick:a=>P.onLogStatusFilter(e),icon:e.icon},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.text),1)])),_:2},1032,["onClick","icon"])))),128))])),_:1})])),default:(0,o.w5)((()=>[(0,o._)("span",null,[(0,o.Uk)((0,n.zw)(m.logStatusColumnLabel)+" ",1),(0,o.Wm)(j,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f)])),_:1})])])),_:1})])),default:(0,o.w5)((e=>[e.row.isSuccess?((0,o.wg)(),(0,o.iD)("span",r,[(0,o.Wm)(b,{type:"success"},{default:(0,o.w5)((()=>[l])),_:1})])):((0,o.wg)(),(0,o.iD)("span",u,[(0,o.Wm)(b,{type:"danger"},{default:(0,o.w5)((()=>[i])),_:1})]))])),_:1}),(0,o.Wm)(h,{label:"错误信息"},{default:(0,o.w5)((e=>[e.row.isSuccess?((0,o.wg)(),(0,o.iD)("span",p)):((0,o.wg)(),(0,o.iD)("span",g,(0,n.zw)(e.row.operationResponse.errMessage),1))])),_:1}),(0,o.Wm)(h,{label:"涉及分组"},{default:(0,o.w5)((e=>[e.row.involvedGroup?((0,o.wg)(),(0,o.j4)(y,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.row.involvedGroup.name),1)])),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",s," - "))])),_:1}),(0,o.Wm)(h,{label:"涉及项目"},{default:(0,o.w5)((e=>[e.row.involvedProject?((0,o.wg)(),(0,o.j4)(y,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.row.involvedProject.name),1)])),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",c," - "))])),_:1}),(0,o.Wm)(h,{label:"涉及用户"},{default:(0,o.w5)((e=>[e.row.involvedUser?((0,o.wg)(),(0,o.j4)(y,{key:0},{default:(0,o.w5)((()=>[(0,o.Uk)((0,n.zw)(e.row.involvedUser.nickname),1)])),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",d," - "))])),_:1}),(0,o.Wm)(h,{prop:"createAt",label:"记录时间"})])),_:1},8,["data"])])),_:1}),(0,o.Wm)(_,null,{default:(0,o.w5)((()=>[(0,o.Wm)(W,{layout:"prev, pager, next","hide-on-single-page":!1,currentPage:m.projectOperationLogPageData.number,"page-size":m.projectOperationLogPageData.size,"page-count":m.projectOperationLogPageData.totalPages,onCurrentChange:P.onProjectOperationLogCurrentPageChange},null,8,["currentPage","page-size","page-count","onCurrentChange"])])),_:1})])),_:1})}var m=t(5430),P={data(){return{projectOperationLogPageData:{data:[],number:1,size:10,totalElements:0,totalPages:1},projectOperationLogPageQuery:{page:0,size:10,isSuccess:null,involveProjectId:null,module:null},logStatusColumnLabel:"全部",logStatusMap:[{text:"全部",icon:"List",value:null},{text:"成功",icon:"CircleCheck",value:!0},{text:"失败",icon:"CircleClose",value:!1}]}},created(){this.fetchProjectOperationLogs()},methods:{fetchProjectOperationLogs(e){this.projectOperationLogPageQuery.page=e?e-1:null,(0,m.v)(this.projectOperationLogPageQuery).then((e=>{e.errCode||(this.projectOperationLogPageData.data=e.data.content,this.projectOperationLogPageData.number=e.data.number+1,this.projectOperationLogPageData.size=e.data.size,this.projectOperationLogPageData.totalPages=e.data.totalPages,this.projectOperationLogPageData.totalElements=e.data.totalElements)}))},onProjectOperationLogCurrentPageChange(e){e&&e-1!=this.projectOperationLogPageQuery.page&&(this.projectOperationLogPageQuery.page=e-1,this.fetchProjectOperationLogs(e))},onQuery(){this.fetchProjectOperationLogs()},onLogStatusFilter(e){this.projectOperationLogPageQuery.isSuccess=e.value,null==e.value?this.logStatusColumnLabel="状态":this.logStatusColumnLabel=e.text,this.onQuery()}}},h=t(83744);const f=(0,h.Z)(P,[["render",w]]);var j=f}}]);
//# sourceMappingURL=17.a55e2565.js.map