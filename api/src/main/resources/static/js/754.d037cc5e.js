"use strict";(self["webpackChunkdatabasir_frontend"]=self["webpackChunkdatabasir_frontend"]||[]).push([[754],{8787:function(e,a,t){t.d(a,{aF:function(){return r},nK:function(){return o},Hj:function(){return u},Jp:function(){return i},FO:function(){return d},ri:function(){return m},KT:function(){return s}});var p=t(3872);const l="/oauth2",r=()=>p.Z.get(l+"/apps"),o=(e,a)=>p.Z.get(l+"/authorization/"+e,{params:a}),n="/api/v1.0/oauth2_apps",u=e=>p.Z.get(n,{params:e}),i=e=>p.Z["delete"](n+"/"+e),d=e=>p.Z.get(n+"/"+e),m=e=>p.Z.post(n,e),s=e=>p.Z.patch(n,e)},1082:function(e,a,t){t.d(a,{Z:function(){return m}});var p=t(6252),l=t(3577);const r=["src"],o=["src"];function n(e,a,n,u,i,d){const m=(0,p.up)("el-tooltip");return"github"==n.appType.toLowerCase()?((0,p.wg)(),(0,p.j4)(m,{key:0,content:n.appName,effect:"light"},{default:(0,p.w5)((()=>[(0,p._)("img",{src:n.appIcon?n.appIcon:t(9710),style:{"max-width":"20px","max-height":"20px"}},null,8,r)])),_:1},8,["content"])):"gitlab"==n.appType.toLowerCase()?((0,p.wg)(),(0,p.j4)(m,{key:1,content:n.appName,effect:"light"},{default:(0,p.w5)((()=>[(0,p._)("img",{src:n.appIcon?n.appIcon:t(4386),style:{"max-width":"20px","max-height":"20px"}},null,8,o)])),_:1},8,["content"])):((0,p.wg)(),(0,p.iD)(p.HY,{key:2},[(0,p.Uk)((0,l.zw)(n.appType),1)],64))}var u={props:{appType:String,appIcon:String,appName:String}},i=t(3744);const d=(0,i.Z)(u,[["render",n]]);var m=d},7754:function(e,a,t){t.r(a),t.d(a,{default:function(){return h}});var p=t(6252),l=t(3577);const r=(0,p.Uk)(" 编辑 "),o=(0,p.Uk)(" 删除 "),n=(0,p.Uk)("保存"),u=(0,p.Uk)("取消");function i(e,a,t,i,d,m){const s=(0,p.up)("el-button"),c=(0,p.up)("el-tooltip"),g=(0,p.up)("el-col"),h=(0,p.up)("el-input"),f=(0,p.up)("el-option"),w=(0,p.up)("el-select"),W=(0,p.up)("el-row"),y=(0,p.up)("el-header"),D=(0,p.up)("el-table-column"),_=(0,p.up)("oauth2-app-type"),b=(0,p.up)("el-link"),C=(0,p.up)("el-space"),U=(0,p.up)("el-table"),P=(0,p.up)("el-form-item"),F=(0,p.up)("info-filled"),V=(0,p.up)("el-icon"),A=(0,p.up)("el-divider"),k=(0,p.up)("el-form"),I=(0,p.up)("el-dialog"),T=(0,p.up)("el-main"),v=(0,p.up)("el-pagination"),S=(0,p.up)("el-footer"),z=(0,p.up)("el-container");return(0,p.wg)(),(0,p.j4)(z,null,{default:(0,p.w5)((()=>[(0,p.Wm)(y,null,{default:(0,p.w5)((()=>[(0,p.Wm)(W,{gutter:12},{default:(0,p.w5)((()=>[(0,p.Wm)(g,{span:2},{default:(0,p.w5)((()=>[(0,p.Wm)(c,{content:"创建应用",placement:"top"},{default:(0,p.w5)((()=>[(0,p.Wm)(s,{type:"primary",icon:"plus",style:{width:"100%"},onClick:a[0]||(a[0]=e=>m.onAppCreate())})])),_:1})])),_:1}),(0,p.Wm)(g,{span:6},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{onChange:m.onQuery,modelValue:d.appPageQuery.appNameContains,"onUpdate:modelValue":a[1]||(a[1]=e=>d.appPageQuery.appNameContains=e),label:"应用名称",placeholder:"应用名称搜素","prefix-icon":"search"},null,8,["onChange","modelValue"])])),_:1}),(0,p.Wm)(g,{span:3},{default:(0,p.w5)((()=>[(0,p.Wm)(w,{modelValue:d.appPageQuery.appType,"onUpdate:modelValue":a[2]||(a[2]=e=>d.appPageQuery.appType=e),placeholder:"应用类型",onChange:m.onQuery,clearable:""},{default:(0,p.w5)((()=>[((0,p.wg)(!0),(0,p.iD)(p.HY,null,(0,p.Ko)(d.appTypes,(e=>((0,p.wg)(),(0,p.j4)(f,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})])),_:1})])),_:1}),(0,p.Wm)(T,null,{default:(0,p.w5)((()=>[(0,p.Wm)(U,{data:d.appPageData.data},{default:(0,p.w5)((()=>[(0,p.Wm)(D,{prop:"registrationId",label:"应用 ID"}),(0,p.Wm)(D,{prop:"appType",label:"应用类型"},{default:(0,p.w5)((e=>[(0,p.Wm)(_,{"app-type":e.row.appType,"app-name":e.row.appName},null,8,["app-type","app-name"]),(0,p.Uk)(" "+(0,l.zw)(e.row.appType),1)])),_:1}),(0,p.Wm)(D,{prop:"appName",label:"名称"}),(0,p.Wm)(D,{label:"授权地址"},{default:(0,p.w5)((e=>[(0,p.Wm)(b,{type:"info"},{default:(0,p.w5)((()=>[(0,p.Uk)((0,l.zw)(e.row.authUrl),1)])),_:2},1024)])),_:1}),(0,p.Wm)(D,{label:"资源地址"},{default:(0,p.w5)((e=>[(0,p.Wm)(b,{type:"info"},{default:(0,p.w5)((()=>[(0,p.Uk)((0,l.zw)(e.row.resourceUrl),1)])),_:2},1024)])),_:1}),(0,p.Wm)(D,{prop:"clientId",label:"Client ID"}),(0,p.Wm)(D,{prop:"updateAt",label:"更新时间"}),(0,p.Wm)(D,{prop:"createAt",label:"创建时间"}),(0,p.Wm)(D,{label:"操作"},{default:(0,p.w5)((e=>[(0,p.Wm)(C,null,{default:(0,p.w5)((()=>[(0,p.Wm)(s,{type:"primary",size:"small",icon:"Edit",onClick:a=>m.onAppEdit(e.row)},{default:(0,p.w5)((()=>[r])),_:2},1032,["onClick"]),(0,p.Wm)(s,{type:"danger",onClick:a=>m.onDelete(e.row),size:"small",icon:"Delete"},{default:(0,p.w5)((()=>[o])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,p.Wm)(I,{modelValue:d.isShowEditAppDialog,"onUpdate:modelValue":a[12]||(a[12]=e=>d.isShowEditAppDialog=e),width:"38%",center:"","destroy-on-close":""},{default:(0,p.w5)((()=>[(0,p.Wm)(k,{model:d.appFormData,rules:d.appFormDataRule,ref:"appFormDataRef","label-position":"top"},{default:(0,p.w5)((()=>[(0,p.Wm)(W,{gutter:28},{default:(0,p.w5)((()=>[(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"应用 ID",prop:"registrationId"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.registrationId,"onUpdate:modelValue":a[3]||(a[3]=e=>d.appFormData.registrationId=e),placeholder:"建议输入全英文字符"},null,8,["modelValue"])])),_:1})])),_:1}),(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"应用名称",prop:"appName"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.appName,"onUpdate:modelValue":a[4]||(a[4]=e=>d.appFormData.appName=e),placeholder:"用户可理解的登陆应用名"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,p.Wm)(P,{label:"应用类型",prop:"appName"},{default:(0,p.w5)((()=>[(0,p.Wm)(w,{modelValue:d.appFormData.appType,"onUpdate:modelValue":a[5]||(a[5]=e=>d.appFormData.appType=e),placeholder:"请选择应用类型",size:"default"},{default:(0,p.w5)((()=>[((0,p.wg)(!0),(0,p.iD)(p.HY,null,(0,p.Ko)(d.appTypes,(e=>((0,p.wg)(),(0,p.j4)(f,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,p.Wm)(W,{gutter:28},{default:(0,p.w5)((()=>[(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"Client Id",prop:"clientId"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.clientId,"onUpdate:modelValue":a[6]||(a[6]=e=>d.appFormData.clientId=e),placeholder:"Oauth2 平台下发的 clientId"},null,8,["modelValue"])])),_:1})])),_:1}),(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"Client Secret",prop:"clientSecret"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.clientSecret,"onUpdate:modelValue":a[7]||(a[7]=e=>d.appFormData.clientSecret=e),placeholder:"Oauth2 平台下发的秘钥"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,p.Wm)(W,{gutter:28},{default:(0,p.w5)((()=>[(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"授权地址",prop:"authUrl"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.authUrl,"onUpdate:modelValue":a[8]||(a[8]=e=>d.appFormData.authUrl=e),placeholder:"用于获取 access token 的服务地址"},null,8,["modelValue"])])),_:1})])),_:1}),(0,p.Wm)(g,{span:10},{default:(0,p.w5)((()=>[(0,p.Wm)(P,{label:"资源地址",prop:"resourceUrl"},{default:(0,p.w5)((()=>[(0,p.Wm)(h,{modelValue:d.appFormData.resourceUrl,"onUpdate:modelValue":a[9]||(a[9]=e=>d.appFormData.resourceUrl=e),placeholder:"用于获取用户信息的服务地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),(0,p.Wm)(W,{style:{"margin-bottom":"33px"}},{default:(0,p.w5)((()=>[(0,p.Wm)(g,null,{default:(0,p.w5)((()=>[(0,p.Wm)(A,null,{default:(0,p.w5)((()=>[(0,p.Wm)(V,{color:"#000"},{default:(0,p.w5)((()=>[(0,p.Wm)(F)])),_:1}),(0,p.Uk)(" 请在 "+(0,l.zw)(d.appFormData.appType)+" 中配置回调地址 ",1)])),_:1}),(0,p.Wm)(b,{type:"primary"},{default:(0,p.w5)((()=>[(0,p.Uk)((0,l.zw)(d.redirectUri)+(0,l.zw)(d.appFormData.registrationId),1)])),_:1})])),_:1})])),_:1}),(0,p.Wm)(P,null,{default:(0,p.w5)((()=>[(0,p.Wm)(s,{type:"primary",onClick:a[10]||(a[10]=e=>m.onAppSave("groupFormRef"))},{default:(0,p.w5)((()=>[n])),_:1}),(0,p.Wm)(s,{onClick:a[11]||(a[11]=e=>d.isShowEditAppDialog=!1)},{default:(0,p.w5)((()=>[u])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue"])])),_:1}),(0,p.Wm)(S,null,{default:(0,p.w5)((()=>[(0,p.Wm)(v,{layout:"prev, pager, next","hide-on-single-page":!1,currentPage:d.appPageData.number,"page-size":d.appPageData.size,"page-count":d.appPageData.totalPages,onCurrentChange:m.onAppCurrentPageChange},null,8,["currentPage","page-size","page-count","onCurrentChange"])])),_:1})])),_:1})}var d=t(8787),m=t(1082),s={components:{Oauth2AppType:m.Z},data(){return{appPageData:{data:[],number:1,size:10,totalElements:0,totalPages:1},appPageQuery:{page:0,size:10,appNameContains:null,appType:null},isShowEditAppDialog:!1,redirectUri:"",appFormData:{id:null},appFormDataRule:{registrationId:[{required:!0,message:"请为应用配置唯一 ID",trigger:"blur"}],appName:[{required:!0,message:"请输入应用名称",trigger:"blur"}],appType:[{required:!0,message:"请选择应用类型",trigger:"blur"}],authUrl:[{required:!0,message:"请配置请求授权地址",trigger:"blur"}],resourceUrl:[{required:!0,message:"请配置资源 API 地址",trigger:"blur"}],clientId:[{required:!0,message:"请配置申请的 clientId",trigger:"blur"}],clientSecret:[{required:!0,message:"请配置申请的 clientSecret",trigger:"blur"}]},appTypes:["GITLAB","GITHUB"]}},created(){this.redirectUri=window.location.protocol+"//"+window.location.host+"/login/oauth2/",this.fetchApps()},methods:{fetchApps(e){this.appPageQuery.page=e?e-1:null,""==this.appPageQuery.appType&&(this.appPageQuery.appType=null),(0,d.Hj)(this.appPageQuery).then((e=>{e.errCode||(this.appPageData.data=e.data.content,this.appPageData.number=e.data.number+1,this.appPageData.size=e.data.size,this.appPageData.totalPages=e.data.totalPages,this.appPageData.totalElements=e.data.totalElements)}))},onAppCurrentPageChange(e){e&&e-1!=this.appPageQuery.page&&(this.appPageQuery.page=e-1,this.fetchApps(e))},onQuery(){this.fetchApps()},onAppEdit(e){(0,d.FO)(e.id).then((e=>{e.errCode||(this.appFormData=e.data,this.isShowEditAppDialog=!0)}))},onAppCreate(){this.appFormData={},this.isShowEditAppDialog=!0},onDelete(e){this.$confirm("确认删除该 APP 登录方式吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{(0,d.Jp)(e.id).then((e=>{e.errCode||(this.$message.success("删除成功"),this.fetchApps())}))}))},onAppSave(){this.$refs.appFormDataRef.validate((e=>{e?this.appFormData.id?(0,d.KT)(this.appFormData).then((e=>{e.errCode||(this.$message.success("更新成功"),this.isShowEditAppDialog=!1,this.fetchApps())})):(0,d.ri)(this.appFormData).then((e=>{e.errCode||(this.$message.success("创建成功"),this.isShowEditAppDialog=!1,this.fetchApps())})):this.$message.error("请填写表单必填项")}))}}},c=t(3744);const g=(0,c.Z)(s,[["render",i]]);var h=g},9710:function(e,a,t){e.exports=t.p+"img/github.e45f4724.svg"},4386:function(e,a,t){e.exports=t.p+"img/gitlab.6b1155ee.svg"}}]);
//# sourceMappingURL=754.d037cc5e.js.map