"use strict";(self["webpackChunkdatabasir"]=self["webpackChunkdatabasir"]||[]).push([[842],{5430:function(e,t,n){n.d(t,{v:function(){return u}});var o=n(63872),a="/api/v1.0/operation_logs",u=function(e){return o.Z.get(a,{params:e})}},22842:function(e,t,n){n.r(t),n.d(t,{default:function(){return h}});n(68309);var o=n(66252),a=n(3577),u={key:0},r=(0,o.Uk)("成功"),l={key:1},i=(0,o.Uk)("失败"),c={key:0},p={key:1},g={key:1},s={key:1},d={key:1};function f(e,t,n,f,w,m){var v=(0,o.up)("el-table-column"),L=(0,o.up)("arrow-down"),h=(0,o.up)("el-icon"),k=(0,o.up)("el-dropdown-item"),P=(0,o.up)("el-dropdown-menu"),j=(0,o.up)("el-dropdown"),b=(0,o.up)("el-tag"),_=(0,o.up)("el-link"),C=(0,o.up)("el-table"),y=(0,o.up)("el-main"),O=(0,o.up)("el-pagination"),W=(0,o.up)("el-footer"),D=(0,o.up)("el-container");return(0,o.wg)(),(0,o.j4)(D,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(y,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(C,{data:w.projectOperationLogPageData.data},{default:(0,o.w5)((function(){return[(0,o.Wm)(v,{prop:"id",label:""}),(0,o.Wm)(v,{label:"系统模块"},{header:(0,o.w5)((function(){return[(0,o.Wm)(j,null,{dropdown:(0,o.w5)((function(){return[(0,o.Wm)(P,null,{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(w.logModuleMap,(function(e,t){return(0,o.wg)(),(0,o.j4)(k,{key:t,onClick:function(t){return m.onLogModuleFilter(e)},icon:e.icon},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.text),1)]})),_:2},1032,["onClick","icon"])})),128))]})),_:1})]})),default:(0,o.w5)((function(){return[(0,o._)("span",null,[(0,o.Uk)((0,a.zw)(w.logModuleColumnLabel)+" ",1),(0,o.Wm)(h,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(L)]})),_:1})])]})),_:1})]})),default:(0,o.w5)((function(e){return[(0,o.Uk)((0,a.zw)(e.row.operationModule),1)]})),_:1}),(0,o.Wm)(v,{prop:"operatorNickname",label:"操作人"}),(0,o.Wm)(v,{prop:"operationName",label:"操作"}),(0,o.Wm)(v,{label:"状态"},{header:(0,o.w5)((function(){return[(0,o.Wm)(j,null,{dropdown:(0,o.w5)((function(){return[(0,o.Wm)(P,null,{default:(0,o.w5)((function(){return[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(w.logStatusMap,(function(e,t){return(0,o.wg)(),(0,o.j4)(k,{key:t,onClick:function(t){return m.onLogStatusFilter(e)},icon:e.icon},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.text),1)]})),_:2},1032,["onClick","icon"])})),128))]})),_:1})]})),default:(0,o.w5)((function(){return[(0,o._)("span",null,[(0,o.Uk)((0,a.zw)(w.logStatusColumnLabel)+" ",1),(0,o.Wm)(h,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(L)]})),_:1})])]})),_:1})]})),default:(0,o.w5)((function(e){return[e.row.isSuccess?((0,o.wg)(),(0,o.iD)("span",u,[(0,o.Wm)(b,{type:"success"},{default:(0,o.w5)((function(){return[r]})),_:1})])):((0,o.wg)(),(0,o.iD)("span",l,[(0,o.Wm)(b,{type:"danger"},{default:(0,o.w5)((function(){return[i]})),_:1})]))]})),_:1}),(0,o.Wm)(v,{label:"错误信息"},{default:(0,o.w5)((function(e){return[e.row.isSuccess?((0,o.wg)(),(0,o.iD)("span",c)):((0,o.wg)(),(0,o.iD)("span",p,(0,a.zw)(e.row.operationResponse.errMessage),1))]})),_:1}),(0,o.Wm)(v,{label:"涉及分组"},{default:(0,o.w5)((function(e){return[e.row.involvedGroup?((0,o.wg)(),(0,o.j4)(_,{key:0},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.row.involvedGroup.name),1)]})),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",g," - "))]})),_:1}),(0,o.Wm)(v,{label:"涉及项目"},{default:(0,o.w5)((function(e){return[e.row.involvedProject?((0,o.wg)(),(0,o.j4)(_,{key:0},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.row.involvedProject.name),1)]})),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",s," - "))]})),_:1}),(0,o.Wm)(v,{label:"涉及用户"},{default:(0,o.w5)((function(e){return[e.row.involvedUser?((0,o.wg)(),(0,o.j4)(_,{key:0},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,a.zw)(e.row.involvedUser.nickname),1)]})),_:2},1024)):((0,o.wg)(),(0,o.iD)("span",d," - "))]})),_:1}),(0,o.Wm)(v,{prop:"createAt",label:"记录时间"})]})),_:1},8,["data"])]})),_:1}),(0,o.Wm)(W,null,{default:(0,o.w5)((function(){return[(0,o.Wm)(O,{layout:"prev, pager, next","hide-on-single-page":!1,currentPage:w.projectOperationLogPageData.number,"page-size":w.projectOperationLogPageData.size,"page-count":w.projectOperationLogPageData.totalPages,onCurrentChange:m.onProjectOperationLogCurrentPageChange},null,8,["currentPage","page-size","page-count","onCurrentChange"])]})),_:1})]})),_:1})}var w=n(5430),m={data:function(){return{projectOperationLogPageData:{data:[],number:1,size:10,totalElements:0,totalPages:1},projectOperationLogPageQuery:{page:0,size:10,isSuccess:null,involveProjectId:null,module:null},logStatusColumnLabel:"状态",logStatusMap:[{text:"全部",icon:"List",value:null},{text:"成功",icon:"CircleCheck",value:!0},{text:"失败",icon:"CircleClose",value:!1}],logModuleColumnLabel:"模块",logModuleMap:[{text:"全部",icon:"List",value:null},{text:"项目",icon:"Filter",value:"project"},{text:"分组",icon:"Filter",value:"group"},{text:"用户",icon:"Filter",value:"user"},{text:"OAuth2",icon:"Filter",value:"login_app"},{text:"设置",icon:"Filter",value:"setting"},{text:"数据库扩展",icon:"Filter",value:"database_type"},{text:"登录",icon:"Filter",value:"login"},{text:"未知",icon:"Filter",value:"UNKNOWN"}]}},created:function(){this.fetchProjectOperationLogs()},methods:{fetchProjectOperationLogs:function(e){var t=this;this.projectOperationLogPageQuery.page=e?e-1:null,(0,w.v)(this.projectOperationLogPageQuery).then((function(e){e.errCode||(t.projectOperationLogPageData.data=e.data.content,t.projectOperationLogPageData.number=e.data.number+1,t.projectOperationLogPageData.size=e.data.size,t.projectOperationLogPageData.totalPages=e.data.totalPages,t.projectOperationLogPageData.totalElements=e.data.totalElements)}))},onProjectOperationLogCurrentPageChange:function(e){e&&e-1!=this.projectOperationLogPageQuery.page&&(this.projectOperationLogPageQuery.page=e-1,this.fetchProjectOperationLogs(e))},onQuery:function(){this.fetchProjectOperationLogs()},onLogStatusFilter:function(e){this.projectOperationLogPageQuery.isSuccess=e.value,null==e.value?this.logStatusColumnLabel="状态":this.logStatusColumnLabel=e.text,this.onQuery()},onLogModuleFilter:function(e){this.projectOperationLogPageQuery.module=e.value,null==e.value?this.logModuleColumnLabel="模块":this.logModuleColumnLabel=e.text,this.onQuery()}}},v=n(83744);const L=(0,v.Z)(m,[["render",f]]);var h=L}}]);
//# sourceMappingURL=842-legacy.3aa4e234.js.map